<!--
    Name: Jeonghyeon Lee
    Date: Feb 6th
-->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="description" content="Object Detection description page">
    <meta name="keywords" content="customer, registeration">
    <meta name="author" content="Jeonghyeon Lee">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prevention of alleyway accidents with MOG2 and GIS</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
</head>

<body class="container px-4 py-5" id="featured-3">
    <header>
        <h1 class="pb-2 border-bottom">Prevention of alleyway accidents with MOG2 and GIS</h1>

        <nav class="nav">
            <a class="nav-link" href="#hd1">Analysis data and analysis tools</a>
            <a class="nav-link" href="#hd2">Analysis Results using GIS and Insight</a>
            <a class="nav-link" href="#hd3">OpenCV MOG2 algorithm for Object tracking</a>
            <a class="nav-link" href="#hd4">References</a>
        </nav>

    </header>

    <main>


        <div>
            <div class="feature col my-5">
                <h3 class="fs-2">Project Overview</h3>
                <hr>
                <p>
                    <b>1. Background and Necessity</b> <br>
                    <p class="mx-3">A traffic accident is any case that creates a traffic hazard. The social cost of traffic accidents is
                    estimated at 32 billion USD a year in South Korea.
                    According to data released by the Seoul Metropolitan Police Agency, Gangseo-gu (a district in Seoul) and
                    Gangnam-gu (a district in Seoul) are known to have the most frequent traffic fatalities among 25 autonomous
                    districts in Seoul in 2020. According to the ‘2017 Traffic Statistics of the Korea Machinery Industry
                    Promotion Association.’ the number of fatalities in traffic accidents occurring on living roads reached 57%.
                    To make Gangseo-gu (a district in Seoul) safe from traffic accidents, we analyze the causes of traffic
                    accidents in Gangseo-gu (a district in Seoul) and propose solutions to reduce traffic accidents based on
                    this.
                    </p>
                </p>
                <div class="row g-4 pt-5 row-cols-1 row-cols-lg-2">
                    <div class="feature col">
                        <p>
                            <b>2. Project purpose</b> <br>
                            <p class="mx-3">When driving a vehicle on a road (alleyway intersection) where visibility is not secured, the
                            existing security CCTV camera on the road will notify/warn the driver or surrounding with lighting
                            if another car/person is coming across from the side of the intersection. Security CCTV cameras
                            analyze movement, and based on this, a warning light on the CCTV camera will prevent accidents at
                            intersections and living roads. The purpose of this analysis is to solve the traffic accident
                            problem.
                            To understand the causes of traffic accidents in Gangseo-gu, indicators and locations related to
                            traffic accidents that occurred in Gangseo-gu from 2016 to 2020 were analyzed. As a result of the
                            analysis, it was confirmed that many traffic accidents occurred at alleyway intersections. To solve
                            this problem, we propose an alternative for securing the driver's field of vision on the road
                            through data analysis and expect to reduce traffic accidents and social costs in Gangseo-gu through
                            this.
                        </p>
                        </p>
                    </div>
                    <div class="feature col pt-5">
                        <img class="img1" src="./resources/images/alleyway.jpg" alt="alleyway-img" style="width: 70%;">
                        <p><b>Figure1.</b> Korean alleyway</p>
                    </div>
                </div>
            </div>
        </div>

    
        <div class="row g-4 py-5 row-cols-1 row-cols-lg-1">
            <h2 id="hd1">Analysis data and analysis tools</h2>
            <hr>
            <ul class="gen mx-4">
                <li>
                    <h4>Traffic Accidents in Gangseo-gu</h4>
                    <ol>
                        <li>
                            Utilization of 'TAAS Traffic Accident Analysis System' traffic data
                        </li>
                        <li>
                            Period of collected data: 2016-2020
                        </li>
                        <li>
                            Details and location (coordinates) data of traffic accidents that occurred in Gangseo-gu
                        </li>
                        <li>
                            The accident situation corresponding to the accident is recorded in detail
                        </li>
                        <li>
                            EDA data with pandas and geopandas libraries and write the coordinates in the data in a form usable
                            to the pydeck library
                        </li>
                    </ol>
                </li>
                <br>
                <li>
                    <h4>Population density of Gangseo-gu</h4>
                    <ol>
                        <li>
                            From 'Seoul Open Data Plaza' we used Seoul population density statistics
                        </li>
                        <li>
                            The latest data currently provided (20 years)
                        </li>
                        <li>
                            Population density is the number of people per area (1 km²)
                        </li>
                        <li>
                            The data records the population and area of each administrative dong registered by 20 years and
                            provides the obtained population density
                        </li>
                    </ol>
                </li>
            </ul>
        </div>


        <div class="row g-4 py-5 row-cols-1 row-cols-lg-1">
            <h2 id="hd2">Analysis Results using GIS and Insight</h2>
            <hr>
            <div class="feature col">
                <img class="img1" src="resources\images\accidentPopulation.jpg" alt="accidentPopulation-img" style="width:100%;">
                <p><b>Figure2.</b> Gangseo-gu Traffic Accident Area and Population Density by Dong (District)</p>
                <p>
                    <b>GIS Links :</b>
                    <a href="./resources/objectDetection/accident.html" target="_blank"><b>Accident GIS</b></a> &nbsp&nbsp
                    <a href="./resources/objectDetection/population.html" target="_blank"><b>Population GIS</b></a>
                </p>
            </div>
            <p>
                Based on the TAAS data on traffic accidents in Gangseo-gu and the population density of Gangseo-gu, the GIS analysis was used
                to visualize the distribution of traffic accidents and the population density of each administrative dong as shown in [Figure 2] 
                to analyze the correlation. In the case of traffic accidents, the data were analyzed by car-to-person.
            </p>

            <div class="row g-4 row-cols-1 row-cols-lg-2">
                <div class="feature col">
                    <p class="pb-2 border-top"></p>
                    <h3>Car to person accident count by district</h3>
                    <div class="feature col pt-5">
                        <img class="img1" src="./resources/images/cartohuman.png" alt="carToHuman-img" style="width: 100%;">
                        <p><b>Figure3.</b> Car to Person accident count by district</p>
                    </div>
                    <p class="gen">
    
                    </p>
    
                    <p class="gen">
                        As shown in [Figure 3], the administrative dong with the highest number of traffic accidents in Gangseo-gu from 2016
                        to 2020 was Hwagok 1-dong, followed by Gayang 1-dong and Banghwa 2-dong. As a result of analyzing the graph in terms
                        of the relationship between population density and traffic accidents, the highest number of traffic accidents
                        occurred in Hwagok 1-dong, a residential area with high population density.
                    </p>
                </div>
    
                <div class="feature col">
                    <p class="pb-2 border-top"></p>
                    <h3>Car to Car accident count by district</h3>
                    <div class="feature col pt-5">
                        <img class="img1" src="./resources/images/cartocar.png" alt="CarToCar-img" style="width: 100%;">
                        <p><b>Figure4.</b> Car to Car accident count by district</p>
                    </div>
                    <p class="gen">
                        Looking at the trend of traffic accidents that occurred in Gayang 1-dong, Banghwa 2-dong and Gonghang dong which have low
                        population density, as shown in [Figure 4], It can be seen that Car-to-Car accidents are relatively common.
                    </p>
                </div>
            </div>
            <div>
            <p>
                Through Gangseo-gu traffic accident data and Seoul population data, the number of accidents and population density in
                Gangseo-gu district were compared and visualized in the corresponding graph. The total number of traffic accidents
                in Gangseo-gu was 7478, and the sum of the top 6 dongs was 2903. Among them, the number of car accidents
            
                Through this analysis, we found that Hwagok 1-dong is the area with the highest number of vehicle-to-person
                accidents in Gangseo-gu, and what we need to note here is that Hwagok 1-dong is the area with the highest population
                density. As can be seen from the graph, it can be seen that there is a correlation between the number of
                car-to-person accidents and population density. It can be seen that the higher the population density, the higher
                the probability of car-to-person accidents. Therefore, we analyzed the characteristics of Hwagok 1-dong, which
                has the highest population density and the highest number of car-to-person accidents, through GIS. In the GIS,
                the areas where car-to-person accidents and car-to-car accidents occurred were displayed and visualized.
                The relevant materials are as follows.
                
                <div class="feature col py-2">
                    <img class="img1" src="resources\images\hwagok1.png" alt="hwagok1DongAccident-img" style="width: 60%;">
                    <p>
                        <b>Figure5.</b> Hwagok 1-dong Living Road Area (alleyway) Accident Location Visualization Data <br>
                        <a href="./resources/objectDetection/accident.html" target="_blank"><b>Accident GIS</b></a>
                    </p>
                    
                </div>
                In the above data, the red dot is the car-to-person, and the white dot is the point
                where the car-to-car accident occurred. As can be seen in the photo, the Hwagok 1-dong area is mainly composed of living
                roads, and there are many accidents along the roads, but it can be confirmed that there are as many accidents on the
                living roads as well. In particular, if you look at the areas highlighted with red circles, which occur frequently, they
                are intersections of three-way and four-way intersections. From this, it can be seen that the frequency of accidents on
                the living roads is high at intersections.
            </p>

            <h3 class="pt-4">
                Solution
            </h3>
            <p>
                Through that, we found the following solution.
                Most of the causes of accidents in alleys are collisions with people or vehicles coming from the direction of
                crossing because it is difficult to secure visibility at intersections. Due to the nature of the housing complex,
                the fact that it is more difficult to secure visibility due to cars parked on both sides of the alley can be seen as
                aggravating the problem.
                To solve this problem, CCTVs around us are used to recognize moving objects, and when approaching a certain level
                close distance from an intersection, a warning light is displayed so that people or vehicles in the orthogonal
                direction can stop with caution. For this purpose, OpenCV was used and moving objects can be recognized in real
                time.
            </p>
        </div>

    
        <div class="row g-4 py-5 row-cols-1 row-cols-lg-1">
            <h2 id="hd3">OpenCV MOG2 algorithm for Object tracking</h2>
            <hr>
            <p>
                Among the real-time background removal methods, an effective and frequently used method will be the Gaussian Mixture
                Model (GMM) or the Mixture of Gaussians (MOG). MOG can handle slow lighting changes, periodic background movement,
                slow-moving objects, long-term scene changes, and camera noise through variables based on pixel values of past
                images. MOG has been widely applied to the development of effective applications with excellent computational
                efficiency and excellent performance for various situations through numerical control. [Source 1]
            </p>
            <p>
                I selected the MOG2 background estimation algorithm, a Gaussian mixture-based background/foreground segmentation
                algorithm, to remove the static background and track the object by referring to the [Source 1] paper. Through the
                MOG2 model, compared to the previous frames, extract only the changed parts, excluding the static elements, and
                express them in white. And by using the outline of the part expressed in white, we increased the recognition rate
                through various techniques and calculations.
            </p>

            <video width="80%" height="10%" controls>
                <source src="./resources/images/opencvvideo.mp4" type="video/mp4">
            </video>
            <p>
                <b>Video1.</b> OpenCV image processing result <br>
                <a href="https://github.com/ryanleedev/OpenCV_ObjectDetection/tree/main/GanseoProject/OpenCV" target="_blank"><b>Code (GIT LINK)</b></a>
            </p>



            <div class="feature col pt-5">
                <img class="img1" src="./resources/images/opencvresult.png" alt="OpencvResult-img" style="width: 100%;">
                <p><b>Figure6.</b> Image processing flowchart</p>
            </div>
            <p>
                As shown in [Figure 6. Image processing flowchart], image frames are sequentially extracted as images, and one
                frame is extracted each time the while statement is repeated once. In the process, we change the color image to
                black and white, select the section where we want to detect a moving object, and do not detect other areas. From
                then on, MOG2 is used in order to remove the static background to black, extract the moving object to white, and
                draw the outline based on the extracted white part through the closing technique, opening technique, and dilation 2
                times, and the outline is set by us. From the moment it touches the red line, it is set to be a word on the Warning
                outline. When the word is actually implemented, a warning light is turned on to warn when a car, motorcycle, or
                person suddenly appears at a crossroad or three-way intersection in an alley. Here, why techniques such as Closing,
                Opening, and Dilation should be included in the middle will be explained in detail later in the report.
            </p>
            <p>
                In the early development stage, we used the createBackgroundSubtractorMOG2 algorithm's history (the number of past
                frames to use as a background), varThershold (threshold value for the square of the Mahalanobis distance between the
                pixel and the model), and detectShadows (shadow detection) to detect false detection. wanted to reduce. Among them,
                by increasing the varThreshold value from the default value of 16 to 80, the recognition rate was slightly lowered,
                but the initial stage was optimized by solving the false detecting error in other surroundings. After that, the
                image was driven in black and white to increase the stability of the model and reduce the delay of the image. In
                order to accurately track an object, it was inevitable for accurate recognition to increase the recognition rate by
                highlighting a moving object while removing noise. For this purpose, Closing, Opening, and Dilation of the shape
                transformation mentioned above were applied, and it can be easily understood by looking at the figure below.
            </p>
            <div class="feature col pt-2">
                <img class="img1" src="./resources/images/opvencvprocess.png" alt="openCVprocess-img" style="width: 100%;">
                <p><b>&nbsp&nbsp&nbsp Figure7.</b> Erosion and Dilation</p>
            </div>
            <p>
                Through [Figure 7] above, we can remove the surrounding noise by gradually reducing the object area through erosion,
                and through Dilation, we can increase the recognition rate of the object by filling the holes
                inside the object. Through this, the closing and opening techniques can be well explained.
            </p>
            <div class="row g-4 row-cols-1 row-cols-lg-2">
                <div class="feature col">
                    <p class="pb-2 border-top"></p>
                    <h3>Closing technique</h3>
                    <div class="feature col pt-1">
                        <img class="img1" src="./resources/images/closing.png" alt="Closing technique" style="width: 100%;">
                        <p><b>Figure8.</b> Closing technique</p>
                    </div>
                    <p class="gen">
                        In the case of the closing technique, it undergoes an erosion process after expansion. That is, after expanding the
                        object, it is possible to fill in the holes of the object without further increasing the noise through erosion. As
                        can be seen in [Figure 8] above, the green colored object is emphasized, and the red colored noise is not greatly
                        increased.
                    </p>
                </div>
    
                <div class="feature col">
                    <p class="pb-2 border-top"></p>
                    <h3>Opening technique</h3>
                    <div class="feature col pt-1">
                        <img class="img1" src="./resources/images/opening.png" alt="Opening technique" style="width: 100%;">
                        <p><b>Figure9.</b> Opening technique</p>
                    </div>
                    <p class="gen">
                        In contrast to the closing technique, the opening technique expands after the erosion process. Therefore, while
                        removing the noise, the loss of the object is minimized. As shown in [Figure 9], it can be seen that the object is
                        protected as much as possible, and the noise indicated in red is removed.
                    </p>
                </div>
            </div>

            <p>
                By sequentially applying these closing and opening techniques, the object to be recognized can be highlighted and
                the surrounding noise can be removed. After that, Dilation was applied two more times to increase the recognition of
                distant objects. When setting the outline, we designed the object to have an outline when the recognized object is
                larger than a certain size. However, this hinders the creation of outlines on distant objects. Therefore, it was
                improved by adding the Dilation operation twice. Through this, the pain point could be improved by increasing the
                recognition rate by expanding the object.
            </p>

            <h3>Analysis of findings and their consequences</h3>
            <p class="mt-1">
                In the end, the tracking was a series of compromises on whether to reduce false detecting of the reflector or
                recognize distant objects, improve detecting, and stabilize the performance of the model. It was found and
                compromised, and the false detection of the reflector was admitted to some extent, and the recognition rate of
                distant objects was increased, and the object recognition section was limited to roads to make the performance of
                the model stable. As a result, it is much more stable than the earlier model, and the recognition rate can be
                greatly increased.
            </p>

            <h3>Utilization plan and expected effect</h3>
            <p class="mt-1">
                The sector where the project can be utilized is very wide if it is an alley where vehicles, motorcycles, bicycles,
                etc. In particular, it is expected that many accidents can be reduced in places where visibility is
                difficult, such as an alley at an intersection or a three-way intersection. For example, in an alley that
                intersects, it is difficult for drivers and pedestrians to recognize the situation on either side of the road, so an
                accident may be caused by a sudden vehicle or pedestrian. Therefore, if the location of vehicles or pedestrians
                coming from either side is difficult to secure by using CCTV at the intersection of the relevant intersection or
                three-way intersection, and installing warning lights, the vehicle or pedestrians coming from both sides are close
                by stopping the accident. can prevent This is expected to significantly reduce accidents occurring in the alleyways.
            </p>
            <div class="row g-4 row-cols-1 row-cols-lg-1">
                <h2 id="hd4">References</h2>
                <hr>
                <h4>Sources of utilization data and references</h4>
                <ol class="mx-4">
                    <li>
                        [Source 1] SFMOG: Super Fast MOG Based Background Subtraction Algorithm Seokbin Song, Jinheon Kim
                    </li>
                    <li>
                        [Reference Book] Computer Vision and Machine Learning with OpenCV4 (Gilbot, 2019)
                    </li>
                    <li>
                        [Reference Web page] https://docs.opencv.org/4.x/d6/d00/tutorial_py_root.html
                    </li>
                </ol>
            </div>

            <footer>
                <p class="pb-2 border-top"></p>
                <nav class="nav">
                    <a class="nav-link active" aria-current="page" href="#">Top of the page</a>
                </nav>
                <p class="text-end">Formatted and codeed by Ryan(Jeonghyeon) Lee.</p>
            </footer>
        </div>


    
    </main>



</html>